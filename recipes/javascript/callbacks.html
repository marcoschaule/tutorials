<!DOCTYPE html><html><head><meta charset="utf8"><title></title><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-alpha.6/css/bootstrap.min.css"><link rel="stylesheet" type="text/css" href="/css/styles.css"></head><body><div class="container" id="container"><header id="header"><div id="title"><a href="/">Tutorials</a></div><div id="subtitle">Learning by Recipes.</div></header><nav id="navigation"><a href="/">Home</a><a href="/blog.html">Blog</a><a href="/about.html">About</a><a href="/imprint.html">Imprint</a></nav><main id="content"><h1></h1><p><h3 id="Callbacks"><a href="#Callbacks" class="headerlink" title="Callbacks"></a>Callbacks</h3><h4 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h4><ul>
<li>Callbacks are used to execute an action after a current function
has finished.</li>
<li>Callbacks should always be the last argument of a function
definition.</li>
<li>Callbacks, by default, are called with the first parameter being
an error object, followed by any other parameter.</li>
</ul>
<p>Example of callbacks:
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// define the function:</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">someFunction</span>(<span class="params">callback</span>) </span>&#123;</div><div class="line">  <span class="comment">// ... do something ...</span></div><div class="line"></div><div class="line">  <span class="comment">// in case of an error like objErr = &#123; message: 'Some error occured!' &#125;</span></div><div class="line">  callback(objErr);</div><div class="line"></div><div class="line">  <span class="comment">// or in case of success</span></div><div class="line">  callback(<span class="literal">null</span>, objSuccess);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// call the function:</span></div><div class="line">someFunction(<span class="function"><span class="keyword">function</span>(<span class="params">objErr, objResult</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (objErr) &#123;</div><div class="line">    <span class="built_in">console</span>.error(objErr);</div><div class="line">    <span class="keyword">return</span>;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">// do something with objResult</span></div><div class="line">  objResult ...</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<h4 id="Callback-hell"><a href="#Callback-hell" class="headerlink" title="Callback hell"></a>Callback hell</h4><ul>
<li>When working with callbacks, you can run into callback hells.
The callback hell is the nested calling of callbacks.</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">someFunction</span>(<span class="params">callback1</span>) </span>&#123;</div><div class="line">  <span class="comment">// do something ...</span></div><div class="line">  callback1(<span class="function"><span class="keyword">function</span>(<span class="params">callback2</span>) </span>&#123;</div><div class="line">    <span class="comment">// do something ...</span></div><div class="line">    callback2(<span class="function"><span class="keyword">function</span>(<span class="params">callback3</span>) </span>&#123;</div><div class="line">      <span class="comment">// do something ...</span></div><div class="line">      callback3(<span class="function"><span class="keyword">function</span>(<span class="params">callback4</span>) </span>&#123;</div><div class="line">        <span class="comment">// do something ...</span></div><div class="line">        <span class="comment">// ...</span></div><div class="line">      &#125;);</div><div class="line">    &#125;);</div><div class="line">  &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>To avoid that, there are several methods. Using simple callbacks,
you can do:</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// define the functions to call each other:</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">someFunction</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="comment">// do something ...</span></div><div class="line">  callback1();</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">callback1</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="comment">// do something ...</span></div><div class="line">  callback2();</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">callback2</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="comment">// do something ...</span></div><div class="line">  callback2();</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">callback3</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="comment">// do something ...</span></div><div class="line">  callback4();</div><div class="line">&#125;</div><div class="line"><span class="comment">// ...</span></div></pre></td></tr></table></figure>
<ul>
<li>You can call functions before they are defined because of the so called
<em>function hoisting</em>.</li>
<li>Only functions defined in function expression (not
via assignment to a variable) can be hoisted.</li>
<li>Try to avoid function hoisting, since it can lead to problems.</li>
<li>Another possibility to avoid callback hell are the <code>async</code> framework,
Promises, RxJS, Fibers, Futures etc. They are explained in the next
chapter.</li>
</ul>
<p>Example:
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// this works:</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params"></span>) </span>&#123; f2(); &#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f2</span>(<span class="params"></span>) </span>&#123;&#125;</div><div class="line"></div><div class="line"><span class="comment">// this doesn't work:</span></div><div class="line"><span class="keyword">var</span> f1 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; f2(); &#125;; <span class="comment">// =&gt; error, f2 undefined</span></div><div class="line"><span class="keyword">var</span> f2 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;;</div><div class="line"></div><div class="line"><span class="comment">// And this doesn't work either:</span></div><div class="line"><span class="keyword">var</span> f1 = <span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params"></span>) </span>&#123; f2(); &#125;; <span class="comment">// =&gt; error, f2 undefined</span></div><div class="line"><span class="keyword">var</span> f2 = <span class="function"><span class="keyword">function</span> <span class="title">f2</span>(<span class="params"></span>) </span>&#123;&#125;;</div></pre></td></tr></table></figure></p>
<p>Links:</p>
<ul>
<li><a href="http://www.w3schools.com/js/js_hoisting.asp" target="_blank" rel="external">JavaScript Declarations are hoisted (w3scools.com)</a></li>
<li><a href="https://developer.mozilla.org/de/docs/Glossary/Hoisting" target="_blank" rel="external">Hoisting (MDN)</a></li>
<li><a href="http://adripofjavascript.com/blog/drips/variable-and-function-hoisting" target="_blank" rel="external">Variable and function hoisting</a></li>
</ul>
<h4 id="Callbacks-in-loops"><a href="#Callbacks-in-loops" class="headerlink" title="Callbacks in loops"></a>Callbacks in loops</h4><h4 id="Best-Practices"><a href="#Best-Practices" class="headerlink" title="Best Practices"></a>Best Practices</h4><ul>
<li><em>Do</em> write the callback as the last argument of an async function
definition.</li>
<li><em>Do</em> use <strong>one</strong> callback if possible.</li>
<li><em>Do</em> set the first callback parameter to be the error object!</li>
<li><em>Do</em> avoid function hoisting whenever possible.</li>
</ul>
</p></main><footer id="footer">&copy; by Marco Schaule</footer></div></body></html>